--кол-во продаж по категориям
select
	category,
	sum(oi.quantity) as total_sold
from
	order_items oi
join products p on
	p.product_id = oi.product_id
group by
	category
order by
	total_sold desc


--валовая прибыль по категориям
select
	category,
	round(sum(oi.quantity * (p.price - p."cost")), 0) as gross_profit
from
	order_items oi
join products p on
	p.product_id = oi.product_id
group by
	category
order by
	gross_profit desc
